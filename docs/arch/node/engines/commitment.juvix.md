---
icon: octicons/gear-16
search:
  exclude: false
categories:
- engine
tags:
- commitment-engine
- engine-definition
---

??? quote "Juvix imports"

    ```juvix
    module arch.node.engines.commitment;

    import prelude open;
    import arch.node.types.engine open;

    import arch.node.engines.commitment_config open public;
    import arch.node.engines.commitment_messages open public;
    import arch.node.engines.commitment_environment open public;
    import arch.node.engines.commitment_behaviour open public;

    import arch.node.types.anoma as Anoma open;

    open commitment_config_example;
    open commitment_environment_example;
    ```

# Commitment Engine

The Commitment Engine provides digital signature services for a specific
identity within Anoma. It acts as a secure mediator that can generate
cryptographic signatures (see [[Commitment|`Commitment`]]) when given data to sign (`Signable`),
while keeping the signing keys secure and unexposed.

When users request a signature through the engine (via a `MsgCommitmentRequest`
message), it validates their authorisation and returns a cryptographic signature
(via a `MsgCommitmentResponse` message) that proves the identity authorised that
specific data.

In Anoma, Commitment Engines are only spawned by [[Identity Management
Engine|Identity Management Engines]] during identity creation or connection, and
only users with the engine reference can request signatures. This controlled
access ensures that signatures can only be generated by authorised parties while
maintaining the security of the underlying signing keys.

## Components

- [[Commitment Messages]]
- [[Commitment Configuration]]
- [[Commitment Environment]]
- [[Commitment Behaviour]]

## The type for a commitment engine

<!-- --8<-- [start:CommitmentEngine] -->
```juvix
CommitmentEngine : Type :=
  Engine
    CommitmentCfg
    CommitmentLocalState
    CommitmentMailboxState
    CommitmentTimerHandle
    CommitmentActionArguments
    Anoma.Msg
    Anoma.Cfg
    Anoma.Env;
```
<!-- --8<-- [end:CommitmentEngine] -->

### Example of a commitment engine

<!-- --8<-- [start:exampleCommitmentEngine] -->
```juvix
exampleCommitmentEngine : CommitmentEngine :=
  mkEngine@{
    cfg := commitmentCfg;
    env := commitmentEnv;
    behaviour := commitmentBehaviour;
  };
```
<!-- --8<-- [end:exampleCommitmentEngine] -->

where [[Commitment Configuration#commitmentCfg|`commitmentCfg`]] is defined as follows:

--8<-- "./docs/arch/node/engines/commitment_config.juvix.md:commitmentCfg"

[[Commitment Environment#commitmentEnv|`commitmentEnv`]] is defined as follows:

--8<-- "./docs/arch/node/engines/commitment_environment.juvix.md:commitmentEnv"

and [[Commitment Behaviour#commitmentBehaviour|`commitmentBehaviour`]] is defined as follows:

--8<-- "./docs/arch/node/engines/commitment_behaviour.juvix.md:commitmentBehaviour"
